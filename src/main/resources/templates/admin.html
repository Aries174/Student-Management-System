<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Admin</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
<div class="sidebar">
    <h2>FPT Library</h2>
    <ul>
        <li><a href="#">Quản lý sách</a></li>
        <li><a th:href="@{/listCategory}">Quản lý Thể loại</a></li>
        <li><a href="#">Quản lý mượn – trả sách</a></li>
        <li><a href="#">Thông báo & gửi email</a></li>
        <li sec:authorize="!isAuthenticated()"><a href="/FPTLibrary/login" >Đăng nhập</a></li>
        <li sec:authorize="isAuthenticated()">
            <form th:action="@{/logout}" method="post">
                <button type="button" class="btn btn-link">Đăng xuất</button>
            </form>
        </li>
        <li><a href="#">Tài Khoản</a></li>
        <li><a href="#">Cài đặt</a></li>
    </ul>
</div>
<div class="product-container">
    <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
        <form action="/FPTLibrary/searchBook" method="get" style="display: flex; gap: 10px;">
            <input type="text" name="keyword" class="form-control" placeholder="Tìm kiếm theo tên sách..."
                   style="max-width: 250px;">
            <button type="submit" class="btn btn-success">Tìm kiếm</button>
        </form>
    </div>
    <a th:href="@{/addBook}" class="btn btn-primary add-btn">Thêm sản phẩm</a>
    <table>
        <thead>
        <tr>
            <th>Mã Số</th>
            <th>Tên Sách</th>
            <th>Nhà sản xuất</th>
            <th>Chủ đề</th>
            <th>Số bản còn lại</th>
            <th>Tổng số bản</th>
            <th>Active</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="b:${books}">
            <td th:text="${b.getBookID()}"></td>
            <td th:text="${b.getTitle()}"></td>
            <td th:text="${b.getAuthor()}"></td>
            <td th:text="${b.categoryName}"></td>
            <td th:text="${b.getAvailableCopies()}"></td>
            <td th:text="${b.getTotalCopies()}"></td>
            <td>
                <a th:href="@{/editBook/{id}(id=${b.bookID})}" class="btn edit-btn">Sửa</a>
                <a th:href="@{/deleteBook(id=${b.bookID})}" th:onclick="return confirm('You sure continua?')" class="btn delete-btn">Delete</a>
            </td>
        </tr>
        </tbody>
    </table>
    <div class="pagination">
        <button class="page-btn" disabled>« Trước</button>
        <button class="page-btn active">1</button>
        <button class="page-btn">2</button>
        <button class="page-btn">3</button>
        <button class="page-btn">Sau »</button>
    </div>
</div>
</body>
<script>
    const categoryToggle = document.getElementById('category-toggle');
    const categoryList = document.getElementById('category-list');

    categoryToggle.addEventListener('click', function (event) {
        event.preventDefault(); // Prevent default anchor behavior

        const isOpen = categoryList.style.display === 'block';
        categoryList.style.display = isOpen ? 'none' : 'block';

        // Toggle arrow rotation class
        categoryToggle.classList.toggle('open', !isOpen);

        // Update aria-expanded attribute
        categoryToggle.setAttribute('aria-expanded', String(!isOpen));
    });
    function sortTable(columnIndex) {
        const table = document.getElementById("bookTable");
        const rows = Array.from(table.rows);
        const isAscending = table.dataset.sortOrder === "asc";
        rows.sort((a, b) => {
            const aText = a.cells[columnIndex].innerText;
            const bText = b.cells[columnIndex].innerText;
            if (columnIndex === 4 || columnIndex === 5) { // For numeric columns
                return isAscending ? aText - bText : bText - aText;
            } else {
                return isAscending ? aText.localeCompare(bText) : bText.localeCompare(aText);
            }
        });
        // Clear the table and append sorted rows
        while (table.firstChild) {
            table.removeChild(table.firstChild);
        }
        rows.forEach(row => table.appendChild(row));}

</script>
</html>